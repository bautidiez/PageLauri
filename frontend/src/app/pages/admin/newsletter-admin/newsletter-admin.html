<div class="admin-container">
    <div class="header-section">
        <h2>üì¢ Enviar Newsletter</h2>
        <p class="subtitle">Cre√° y envi√° campa√±as de email marketing a tus suscriptores.</p>
    </div>

    <div class="newsletter-grid">
        <div class="compose-card">
            <div class="form-group">
                <label>Asunto del Correo</label>
                <input type="text" [(ngModel)]="subject" placeholder="Ej: ¬°Llegaron nuevos ingresos! üöÄ">
            </div>

            <div class="form-group">
                <label>Mensaje</label>
                <quill-editor [(ngModel)]="content" placeholder="Escrib√≠ tu mensaje aqu√≠..."
                    [styles]="{height: '300px'}" class="editor-container">
                </quill-editor>
            </div>
        </div>

        <div class="actions-card">
            <h3>Acciones</h3>

            <div class="form-group">
                <button class="btn-verify" (click)="testConnection()" [disabled]="isLoading || isTestingConnection">
                    <span *ngIf="!isTestingConnection">üîå Verificar Conexi√≥n SMTP</span>
                    <span *ngIf="isTestingConnection">‚è≥ Verificando...</span>
                </button>
                <p *ngIf="connectionStatus" [ngClass]="{'status-ok': connectionOk, 'status-error': !connectionOk}"
                    class="status-msg">
                    {{ connectionStatus }}
                </p>
            </div>

            <div class="test-section">
                <label>Email de Prueba</label>
                <input type="email" [(ngModel)]="testEmail" placeholder="tu@email.com">
                <button class="btn-test" (click)="send(true)" [disabled]="isLoading">
                    <span *ngIf="!isLoading">üß™ Probar Env√≠o</span>
                    <span *ngIf="isLoading" class="loader-dots">‚è≥ Enviando...</span>
                </button>
            </div>

            <div class="divider"></div>

            <div class="send-section">
                <p class="warning-text">‚ö†Ô∏è Cuidado: Esto enviar√° el correo a todos los clientes suscritos.</p>
                <button class="btn-send-all" (click)="send(false)" [disabled]="isLoading">
                    <span *ngIf="!isLoading">‚úàÔ∏è Enviar a TODOS</span>
                    <span *ngIf="isLoading">‚è≥ Enviando...</span>
                </button>
            </div>

            <div *ngIf="lastStats" class="stats-box success">
                <h4>√öltimo Env√≠o:</h4>
                <p>Enviados: <strong>{{ lastStats.sent_count }}</strong> / {{ lastStats.total_targets }}</p>
            </div>
        </div>
    </div>
</div>