<div class="recovery-page">
    <div class="container">
        <div class="recovery-card">
            <div class="recovery-header">
                <h2>Restablecer Contraseña</h2>
                <p>Ingresa tu nueva contraseña.</p>
            </div>

            <form (ngSubmit)="onSubmit()" class="recovery-form" *ngIf="!success && !error || (error && password)">

                <div class="message error" *ngIf="error && !password">
                    ⚠️ {{ error }}
                </div>

                <div class="form-group">
                    <label>Nueva Contraseña</label>
                    <input type="password" [(ngModel)]="password" name="password" placeholder="Mínimo 8 caracteres"
                        required minlength="8">
                </div>

                <div class="form-group">
                    <label>Confirmar Contraseña</label>
                    <input type="password" [(ngModel)]="confirmPassword" name="confirmPassword"
                        placeholder="Repite la contraseña" required>
                </div>

                <div class="message error" *ngIf="error">
                    ⚠️ {{ error }}
                </div>

                <button type="submit" class="btn-submit" [disabled]="loading">
                    <span *ngIf="!loading">Cambiar Contraseña</span>
                    <span *ngIf="loading">Procesando...</span>
                </button>
            </form>

            <div class="message success" *ngIf="success">
                ✅ {{ message }}
            </div>

            <div class="message error" *ngIf="error && !password">
                <!-- Mostrado cuando el token falta al inicio -->
                <p>{{ error }}</p>
                <br>
                <a routerLink="/recuperar-password" style="color: inherit; text-decoration: underline;">Solicitar nuevo
                    enlace</a>
            </div>

            <div class="back-link" *ngIf="!success">
                <a routerLink="/login">← Volver al login</a>
            </div>
        </div>
    </div>
</div>