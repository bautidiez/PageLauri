<div class="registro-page"
    style="background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('/assets/portada3.png') center/cover no-repeat fixed !important;">
    <div class="container">
        <div class="registro-card">
            <div class="registro-header">
                <h1>Crear Cuenta</h1>
                <p>Reg√≠strate para recibir nuestras ofertas semanales</p>
            </div>

            <!-- Formulario de Registro -->
            <form (ngSubmit)="registrar()" class="registro-form" *ngIf="!mensajeExito && !esperandoVerificacion">
                <div class="form-group">
                    <label>Nombre Completo *</label>
                    <input type="text" [(ngModel)]="cliente.nombre" name="nombre" placeholder="Tu nombre completo"
                        required>
                </div>

                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" [(ngModel)]="cliente.email" name="email" placeholder="tu@email.com" required>
                </div>

                <div class="form-group">
                    <label>Contrase√±a *</label>
                    <input type="password" [(ngModel)]="cliente.password" name="password" placeholder="Tu contrase√±a"
                        required>
                    <small class="form-hint">M√≠nimo 8 caracteres, 1 may√∫scula, 1 min√∫scula y 1 n√∫mero</small>
                </div>

                <div class="form-group">
                    <label>Tel√©fono *</label>
                    <div class="phone-input-container">
                        <div class="custom-prefix-selector" (click)="toggleDropdown()">
                            <div class="selected-prefix">
                                <img [src]="'https://flagcdn.com/w20/' + getPrefijoActual().iso + '.png'"
                                    [alt]="getPrefijoActual().nombre" class="flag-img">
                                <span>{{ prefijoTelefono }}</span>
                                <i class="chevron-icon">‚ñº</i>
                            </div>
                            <ul class="prefix-dropdown" *ngIf="dropdownAbierto">
                                <li *ngFor="let p of prefijos" (click)="seleccionarPrefijo(p.codigo)">
                                    <img [src]="'https://flagcdn.com/w20/' + p.iso + '.png'" [alt]="p.nombre"
                                        class="flag-img">
                                    <span>{{ p.nombre }} ({{ p.codigo }})</span>
                                </li>
                            </ul>
                        </div>
                        <input type="tel" [(ngModel)]="cliente.telefono" name="telefono" placeholder="358 123456"
                            required>
                    </div>
                </div>


                <div class="form-checkbox" style="display: none;">
                    <re-captcha (resolved)="onCaptchaResolved($event)">
                    </re-captcha>
                </div>

                <div class="form-checkbox">
                    <label>
                        <input type="checkbox" [(ngModel)]="cliente.acepta_newsletter" name="acepta_newsletter">
                        <span>Acepto recibir notificaciones semanales sobre nuevas ofertas y productos</span>
                    </label>
                </div>

                <div class="error-message" *ngIf="mensajeError && !esperandoVerificacion">
                    ‚ö†Ô∏è {{ mensajeError }}
                </div>

                <button type="submit" class="btn-register" [disabled]="registrando">
                    <span *ngIf="!registrando">Crear Cuenta</span>
                    <span *ngIf="registrando">Registrando...</span>
                </button>

                <div class="login-link">
                    <p>¬øYa tienes cuenta? <a routerLink="/login">Iniciar sesi√≥n</a></p>
                </div>
            </form>

            <!-- Formulario de Verificaci√≥n -->
            <div class="verification-step" *ngIf="esperandoVerificacion && !mensajeExito">
                <div class="verification-header">
                    <span class="sms-icon">üì©</span>
                    <h2>Verifica tu Email</h2>
                    <p>Hemos enviado un c√≥digo de 6 d√≠gitos a tu casilla de correo.</p>
                </div>

                <form (ngSubmit)="verificarCodigo()" class="verification-form">
                    <div class="form-group">
                        <label>C√≥digo de Validaci√≥n</label>
                        <input type="text" [(ngModel)]="codigoVerificacion" name="codigo" maxlength="6"
                            inputmode="numeric" pattern="[0-9]*" placeholder="000000" class="code-input" required>
                    </div>

                    <div class="error-message" *ngIf="mensajeError">
                        ‚ö†Ô∏è {{ mensajeError }}
                    </div>

                    <button type="submit" class="btn-verify" [disabled]="verificando">
                        <span *ngIf="!verificando">Validar C√≥digo</span>
                        <span *ngIf="verificando">Verificando...</span>
                    </button>

                    <div class="resend-link">
                        <p>¬øNo recibiste el c√≥digo? <a (click)="reenviarCodigo()" style="cursor: pointer;">Reenviar</a>
                        </p>
                    </div>
                </form>
            </div>

            <!-- Mensaje de √âxito Final -->
            <div class="success-message-box" *ngIf="mensajeExito">
                <div class="success-icon">‚úÖ</div>
                <h2>¬°Verificaci√≥n Exitosa!</h2>
                <p>Tu cuenta ha sido activada correctamente.</p>
                <p class="redirect-message">Redirigiendo al inicio de sesi√≥n...</p>
            </div>
        </div>
    </div>
</div>